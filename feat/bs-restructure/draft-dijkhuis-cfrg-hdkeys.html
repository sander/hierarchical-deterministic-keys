<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Hierarchical Deterministic Keys</title>
<meta content="Sander Dijkhuis" name="author">
<meta content="
       Hierarchical Deterministic Keys enables managing large sets of keys bound to a secure cryptographic device that protects a single key. This enables the development of secure digital identity wallets providing many one-time-use public keys. Some instantiations can be implemented in such a way that the secure cryptographic device does not need to support key blinding, enabling the use of devices that already are widely deployed. 
    " name="description">
<meta content="xml2rfc 3.26.0" name="generator">
<meta content="KDF" name="keyword">
<meta content="draft-dijkhuis-cfrg-hdkeys-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.26.0
    Python 3.12.8
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-dijkhuis-cfrg-hdkeys.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">HDK</td>
<td class="right">February 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Dijkhuis</td>
<td class="center">Expires 15 August 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Crypto Forum</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-dijkhuis-cfrg-hdkeys-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-02-11" class="published">11 February 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-08-15">15 August 2025</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Q. Dijkhuis, <span class="editor">Ed.</span>
</div>
<div class="org">Cleverbase</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Hierarchical Deterministic Keys</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Hierarchical Deterministic Keys enables managing large sets of keys bound to a secure cryptographic device that protects a single key. This enables the development of secure digital identity wallets providing many one-time-use public keys. Some instantiations can be implemented in such a way that the secure cryptographic device does not need to support key blinding, enabling the use of devices that already are widely deployed.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-dijkhuis-cfrg-hdkeys/">https://datatracker.ietf.org/doc/draft-dijkhuis-cfrg-hdkeys/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/sander/hierarchical-deterministic-keys">https://github.com/sander/hierarchical-deterministic-keys</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 15 August 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and definitions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-the-hierarchical-determinis" class="internal xref">The Hierarchical Deterministic Key function</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-introductory-examples" class="internal xref">Introductory examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1" class="keepWithNext"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-local-deterministic-key-der" class="internal xref">Local deterministic key derivation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="auto internal xref">2.1.2</a>.  <a href="#name-remote-deterministic-key-de" class="internal xref">Remote deterministic key derivation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.3">
                    <p id="section-toc.1-1.2.2.1.2.3.1"><a href="#section-2.1.3" class="auto internal xref">2.1.3</a>.  <a href="#name-blinded-proof-of-possession" class="internal xref">Blinded proof of possession</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-instantiation-parameters" class="internal xref">Instantiation parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-the-hdk-context" class="internal xref">The HDK context</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-the-hdk-salt" class="internal xref">The HDK salt</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="auto internal xref">2.5</a>.  <a href="#name-the-hdk-function" class="internal xref">The HDK function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="auto internal xref">2.6</a>.  <a href="#name-the-local-hdk-procedure" class="internal xref">The local HDK procedure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a href="#section-2.7" class="auto internal xref">2.7</a>.  <a href="#name-the-remote-hdk-protocol" class="internal xref">The remote HDK protocol</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.8">
                <p id="section-toc.1-1.2.2.8.1"><a href="#section-2.8" class="auto internal xref">2.8</a>.  <a href="#name-the-hdk-key-alias-format" class="internal xref">The HDK key alias format</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-generic-hdk-instantiations" class="internal xref">Generic HDK instantiations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-using-digital-signatures" class="internal xref">Using digital signatures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-using-prime-order-groups" class="internal xref">Using prime-order groups</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-using-additive-blinding" class="internal xref">Using additive blinding</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-using-multiplicative-blindi" class="internal xref">Using multiplicative blinding</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-using-elliptic-curves" class="internal xref">Using elliptic curves</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-using-ecdh-shared-secrets" class="internal xref">Using ECDH shared secrets</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-using-ec-sdsa-signatures" class="internal xref">Using EC-SDSA signatures</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="auto internal xref">3.3.3</a>.  <a href="#name-using-p-256" class="internal xref">Using P-256</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-concrete-hdk-instantiations" class="internal xref">Concrete HDK instantiations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-hdk-ecdh-p256" class="internal xref">HDK-ECDH-P256</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-hdk-ecdsa-p256add" class="internal xref">HDK-ECDSA-P256add</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-hdk-ecdsa-p256mul" class="internal xref">HDK-ECDSA-P256mul</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-hdk-ecsdsa-p256" class="internal xref">HDK-ECSDSA-P256</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-application-considerations" class="internal xref">Application considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-secure-cryptographic-device" class="internal xref">Secure cryptographic device</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-trust-evidence" class="internal xref">Trust evidence</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-wallet-trust-evidence" class="internal xref">Wallet Trust Evidence</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-issuer-trust-evidence" class="internal xref">Issuer Trust Evidence</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-applying-hdk-in-openid-for-" class="internal xref">Applying HDK in OpenID for Verifiable Credential Issuance</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-applying-hdk-with-arkg" class="internal xref">Applying HDK with ARKG</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-confidentiality-of-key-hand" class="internal xref">Confidentiality of key handles</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document specifies the algorithms to apply Hierarchical Deterministic Keys (HDKeys). The purpose of an HDK architecture is to manage large sets of keys bound to a secure cryptographic device that protects a single key. This enables the development of secure digital identity wallets providing many one-time-use public keys.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The core idea has been introduced in <span>[<a href="#BIP32" class="cite xref">BIP32</a>]</span> to create multiple cryptocurrency addresses in a manageable way. The present document extends the idea towards devices commonly used for digital wallets, and towards common interaction patterns for document issuance and authentication.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">To store many HDKeys, only a seed string needs to be stored confidentially, associated with a device private key. Each HDK is then deterministically defined by a path of indices, optionally alternated by key handles provided by another party. Such a path can efficiently be stored and requires less confidentiality than the seed.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">To prove possession of many HDKeys, the secure cryptographic device only needs to perform common cryptographic operations on a single private key. The HDK acts as a blinding factor that enables blinding the device public key. In several instantiations, such as those <span><a href="#using-ecdh-shared-secrets" class="internal xref">using ECDH shared secrets</a> (<a href="#using-ecdh-shared-secrets" class="auto internal xref">Section 3.3.1</a>)</span> and those <span><a href="#using-ec-sdsa-signatures" class="internal xref">using EC-SDSA signatures</a> (<a href="#using-ec-sdsa-signatures" class="auto internal xref">Section 3.3.2</a>)</span>, the secure cryptographic device does not need to support key blinding natively, and the application can pre-process the input or post-process the output from the device to compute the blinded device authentication data. This enables the application of HDK on devices that are already deployed without native support for HDK.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">This document provides a specification of the generic HDK function, generic HDK instantiations, and fully specified concrete HDK instantiations.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">An HDK instantiation is expected to be applied in a solution deployed as (wallet) units. One unit can have multiple HDK instantiations, for example to manage multiple identities or multiple cryptographic algorithms or key protection mechanisms.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This document represents the consensus of the authors, based on working group input and feedback. It is not a standard. It does not include security or privacy proofs.<a href="#section-1-7" class="pilcrow">¶</a></p>
<div id="conventions-and-definitions">
<section id="section-1.1">
        <h3 id="name-conventions-and-definitions">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and definitions</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">The following notation is used throughout the document.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.1">
            <p id="section-1.1-3.1.1">byte: A sequence of eight bits.<a href="#section-1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-3.2">
            <p id="section-1.1-3.2.1"><code>I2OSP(n, w)</code>: Convert non-negative integer <code>n</code> to a <code>w</code>-length, big-endian byte string, as described in <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>.<a href="#section-1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="the-hierarchical-deterministic-key-function">
<section id="section-2">
      <h2 id="name-the-hierarchical-determinis">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-the-hierarchical-determinis" class="section-name selfRef">The Hierarchical Deterministic Key function</a>
      </h2>
<p id="section-2-1">An HDK instantiation enables local key derivation to create many key pairs from a single seed value. It enables remote parties to generate key handles from which both parties can derive more key pairs asynchronously. Additionally, an HDK instantiation enables securely proving possession of the private keys, such as required in <span>[<a href="#RFC7800" class="cite xref">RFC7800</a>]</span>, either in a centralised or in a distributed manner.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Solutions <span class="bcp14">MAY</span> omit application of the remote functionality. In this case, a unit can only derive keys locally.<a href="#section-2-2" class="pilcrow">¶</a></p>
<div id="introductory-examples">
<section id="section-2.1">
        <h3 id="name-introductory-examples">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-introductory-examples" class="section-name selfRef">Introductory examples</a>
        </h3>
<div id="local-deterministic-key-derivation">
<section id="section-2.1.1">
          <h4 id="name-local-deterministic-key-der">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-local-deterministic-key-der" class="section-name selfRef">Local deterministic key derivation</a>
          </h4>
<p id="section-2.1.1-1">The following example illustrates the use of local key derivation. An HDK tree is associated with a device key pair and initiated using confidential static data: a <code>seed</code> value, which is a byte array containing sufficient entropy. Now tree nodes are constructed as follows.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.1-2">
<pre>
                          +----+ +--+
Confidential static data: |seed| |pk|
                          +-+--+ +--+
                            v
                          +----+ +----+
Level 0 HDKeys:           |hdk0| |hdk1|
                          +-+--+ +----+
                            v
                          +-----+ +-----+ +-----+
Level 1 HDKeys:           |hdk00| |hdk01| |hdk02|
                          +-----+ ++---++ +-----+
                                   v   v
                             +------+ +------+
Level 2 HDKeys at hdk01:     |hdk000| |hdk001| ...
                             +------+ +------+
</pre><a href="#section-2.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-2.1.1-3">The unit computes a Level 0 HDK at the root node using a deterministic function, taking the device public key <code>pk</code> and the <code>seed</code> as input: <code>(pk0, salt0, bf0) = hdk0 = HDK(0, pk, seed)</code>. The HDK consists of a first blinded public key <code>pk0</code>, a first byte string <code>salt0</code> to derive next-level keys, and a first blinding factor <code>bf0</code>. Using <code>bf0</code> and the device key pair, the unit can compute blinded private keys and proofs of possession.<a href="#section-2.1.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1.1-4">The unit computes any Level <code>n &gt; 0</code> HDK from any other HDK <code>(pk, salt, bf)</code> using the same deterministic function: <code>(pk', salt', bf') = hdk' = HDK(index, pk, salt, bf)</code>. The function takes as input the <code>index</code> starting at 0, an the previous-level HDK. The function returns a new HDK as output, which can be used in the same way as the root HDK.<a href="#section-2.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="remote-deterministic-key-derivation">
<section id="section-2.1.2">
          <h4 id="name-remote-deterministic-key-de">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-remote-deterministic-key-de" class="section-name selfRef">Remote deterministic key derivation</a>
          </h4>
<p id="section-2.1.2-1">Instead of local derivation, an HDK salt can also be derived using a key handle that is generated remotely. Using the derived salt, the local and remote parties can derive the same new HDKeys. The remote party can use these to derive public keys. The local party can use these to derive associated private keys for proof of possession.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.2-2">This approach is similar to Asynchronous Remote Key Generation (ARKG) <span>[<a href="#I-D.draft-bradleylundberg-cfrg-arkg-02" class="cite xref">I-D.draft-bradleylundberg-cfrg-arkg-02</a>]</span> when considered at a single level. However, ARKG does not enable distributed proof of possession with deterministic hierarchies. Such hierarchies can be used for example to enable remote parties to derive keys from previously derived keys. Secure cryptographic devices that support ARKG may therefore not support all features of HDK.<a href="#section-2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-2.1.2-3">To enable remote derivation of child HDKeys, the unit uses the parent HDK to derive the parent public key and a second public key for key encapsulation. The issuer returns a key handle, using which both parties can derive a sequence of child HDKeys. Key encapsulation prevents other parties from discovering a link between the public keys of the parent and the children, even if the other party knows the parent HDK or can eavesdrop communications.<a href="#section-2.1.2-3" class="pilcrow">¶</a></p>
<p id="section-2.1.2-4">Locally derived parents can have remotely derived children. Remotely derived parents can have locally derived children.<a href="#section-2.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="blinded-proof-of-possession">
<section id="section-2.1.3">
          <h4 id="name-blinded-proof-of-possession">
<a href="#section-2.1.3" class="section-number selfRef">2.1.3. </a><a href="#name-blinded-proof-of-possession" class="section-name selfRef">Blinded proof of possession</a>
          </h4>
<p id="section-2.1.3-1">The next concept to illustrate is blinded proof of possession. This enables a unit to prove possession of a (device) private key without disclosing the directly associated public key. This way, solutions can avoid linkability across readers of a digital document that is released with proof of possession.<a href="#section-2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-2.1.3-2">In this example, a document is issued with binding to a public key <code>pk'</code>, which is a blinding public key <code>pk</code> blinded with the blinding factor <code>bf</code> in some HDK <code>hdk = (pk', salt, bf)</code>. The unit can present the document with a proof of possession of the corresponding blinded private key, which is the blinding private key <code>sk</code> blinded with <code>bf</code>. The unit applies some authentication function <code>device_data = authenticate(sk, reader_data, bf)</code> to the blinding private key, reader-provided data and the blinding factor. The unit can subsequently use the output <code>device_data</code> to prove possession to the reader using common algorithms.<a href="#section-2.1.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.3-3">
<pre>
+------------------+ +--------+
|       +--+ +---+ | |        |
| Unit  |sk| |hdk| | | Reader |
|       +--+ +---+ | |        |
+---+--------------+ +----+---+
    |                     |
    |                     |
    |  1. Request and     |
    |     reader_data     |
    | &lt;------------------ |
    |                     |
+---+-------------+       |
| 2. authenticate |       |
+---+-------------+       |
    |                     |
    |  3. Proof with      |
    |     device_data     |
    | ------------------&gt; |
    |                     |
    |    +-----------+    |
    |    | Document  |    |
    |    |           |    |
    |    | +---+     |    |
    |    | |pk'|     |    |
    |    | +---+     |    |
    |    |           |    |
         +-----------+
</pre><a href="#section-2.1.3-3" class="pilcrow">¶</a>
</div>
<p id="section-2.1.3-4">The reader does not need to be aware that an HDK function or key blinding was used, since for common algorithms, the blinded public key and the proof are indistinguishable from non-blinded keys and proofs.<a href="#section-2.1.3-4" class="pilcrow">¶</a></p>
<p id="section-2.1.3-5">When applied on HDK level <code>n</code>, the blinding private key <code>sk</code> is the device private key blinded with a combination of <code>n</code> blinding factors. These can either be combined within the secure cryptographic device, by subsequent computation of the blinded private key starting with the device private key, or outside of the secure cryptographic device, by combining the blinding factors outside of the secure cryptographic device.<a href="#section-2.1.3-5" class="pilcrow">¶</a></p>
<p id="section-2.1.3-6">Blinding methods can be constructed such that the secure cryptographic device does not need to be designed for key blinding. In such cases, the computation of <code>device_data</code> is distributed between two parties: the secure cryptographic device using common cryptographic operations, and the unit component invoking these operations. Some blinded proof of possession algorithms can only be centralised.<a href="#section-2.1.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="instantiation-parameters">
<section id="section-2.2">
        <h3 id="name-instantiation-parameters">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-instantiation-parameters" class="section-name selfRef">Instantiation parameters</a>
        </h3>
<p id="section-2.2-1">The parameters of an HDK instantiation are:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-2.1">
            <p id="section-2.2-2.1.1"><code>Ns</code>: The amount of bytes of a salt value with sufficient entropy.<a href="#section-2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-2.2">
            <p id="section-2.2-2.2.1"><code>H</code>: A cryptographic hash function.<a href="#section-2.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-2.2.2.1">
                <p id="section-2.2-2.2.2.1.1">H(msg): Outputs <code>Ns</code> bytes.<a href="#section-2.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-2.2-2.3">
            <p id="section-2.2-2.3.1"><code>BL</code>: A key blinding scheme <span>[<a href="#Wilson2023" class="cite xref">Wilson2023</a>]</span> with opaque blinding factors and algebraic properties, consisting of the functions:<a href="#section-2.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-2.3.2.1">
                <p id="section-2.2-2.3.2.1.1">DeriveBlindKey(ikm): Outputs a blind key <code>bk</code> based on input keying material <code>ikm</code>.<a href="#section-2.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2-2.3.2.2">
                <p id="section-2.2-2.3.2.2.1">BlindPublicKey(pk, bk, ctx): Outputs the result public key <code>pk'</code> of blinding public key <code>pk</code> with blind key <code>bk</code> and application context byte string <code>ctx</code>.<a href="#section-2.2-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2-2.3.2.3">
                <p id="section-2.2-2.3.2.3.1">BlindPrivateKey(sk, bk, ctx): Outputs the result private key <code>sk'</code> of blinding private key <code>sk</code> with blind key <code>bk</code> and application context byte string <code>ctx</code>. The result <code>sk'</code> is such that if <code>pk</code> is the public key for <code>sk</code>, then <code>(sk', pk')</code> forms a key pair for <code>pk' = BlindPublicKey(pk, bk, ctx)</code>.<a href="#section-2.2-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2-2.3.2.4">
                <p id="section-2.2-2.3.2.4.1">Combine(k1, k2): Outputs a blinding factor <code>bf</code> given input keys <code>k1</code> and <code>k2</code> which are either private keys or blinding factors, with the following associative property. For all input keys <code>k1</code>, <code>k2</code>, <code>k3</code>:<a href="#section-2.2-2.3.2.4.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-2.3.2.4.2">
<pre>
Combine(Combine(k1, k2), k3) == Combine(k1, Combine(k2, k3))
</pre><a href="#section-2.2-2.3.2.4.2" class="pilcrow">¶</a>
</div>
</li>
              <li class="normal" id="section-2.2-2.3.2.5">
                <p id="section-2.2-2.3.2.5.1">DeriveBlindingFactor(bk, ctx): Outputs a blinding factor <code>bf</code> based on a blind key <code>bk</code> and an application context byte string <code>ctx</code>, such that for all private keys <code>sk</code>:<a href="#section-2.2-2.3.2.5.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-2.3.2.5.2">
<pre>
BlindPrivateKey(sk, bk, ctx) == Combine(sk, bf)
</pre><a href="#section-2.2-2.3.2.5.2" class="pilcrow">¶</a>
</div>
</li>
              <li class="normal" id="section-2.2-2.3.2.6">
                <p id="section-2.2-2.3.2.6.1">SerializePublicKey(pk): Outputs a canonical byte string serialisation of public key <code>pk</code>.<a href="#section-2.2-2.3.2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-2.2-2.4">
            <p id="section-2.2-2.4.1"><code>KEM</code>: A key encapsulation mechanism <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>, consisting of the functions:<a href="#section-2.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-2.4.2.1">
                <p id="section-2.2-2.4.2.1.1">DeriveKeyPair(ikm): Outputs a key encapsulation key pair <code>(sk, pk)</code>.<a href="#section-2.2-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2-2.4.2.2">
                <p id="section-2.2-2.4.2.2.1">Encap(pk): Outputs <code>(k, c)</code> consisting of a shared secret <code>k</code> and a ciphertext <code>c</code>, taking key encapsulation public key <code>pk</code>.<a href="#section-2.2-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2-2.4.2.3">
                <p id="section-2.2-2.4.2.3.1">Decap(c, sk): Outputs shared secret <code>k</code>, taking ciphertext <code>c</code> and key encapsulation private key <code>sk</code>.<a href="#section-2.2-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-2.2-3">An HDK instantiation <span class="bcp14">MUST</span> specify the instantiation of each of the above functions and values.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">Note that by design of BL, when a document is issued using HDK, the reader does not need to know that HDK was applied: the public key will look like any other public key used for proofs of possession.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2-5">An HDK implementation <span class="bcp14">MAY</span> leave BlindPrivateKey implicit in cases where the blinding method is constructed in a distributed way. In those cases, the secure cryptographic device holding the private key does not need to support key blinding, and the value of the blinded private key is never available during computation.<a href="#section-2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-hdk-context">
<section id="section-2.3">
        <h3 id="name-the-hdk-context">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-the-hdk-context" class="section-name selfRef">The HDK context</a>
        </h3>
<p id="section-2.3-1">A local unit or remote party creates an HDK context from an index.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3-2">
<pre>
Inputs:
- pk, a public key to be blinded.
- index, an integer between 0 and 2^32-1 (inclusive).

Outputs:
- ctx, an application context byte string.

def CreateContext(pk, index):
    ctx = SerializePublicKey(pk) || I2OSP(index, 4)
    return ctx
</pre><a href="#section-2.3-2" class="pilcrow">¶</a>
</div>
<p id="section-2.3-3">This context byte string is used as input for DeriveBlindingFactor, BlindPrivateKey, BlindPublicKey, and <span><a href="#the-hdk-salt" class="internal xref">DeriveSalt</a> (<a href="#the-hdk-salt" class="auto internal xref">Section 2.4</a>)</span>.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-hdk-salt">
<section id="section-2.4">
        <h3 id="name-the-hdk-salt">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-the-hdk-salt" class="section-name selfRef">The HDK salt</a>
        </h3>
<p id="section-2.4-1">A local unit or remote party derives a next-level HDK salt from within an HDK context.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.4-2">
<pre>
Inputs:
- salt, a string of Ns bytes.
- ctx, an HDK context byte string.

Outputs:
- salt', the next salt for HDK derivation.

def DeriveSalt(salt, ctx):
    salt' = H(salt || ctx)
    return salt'
</pre><a href="#section-2.4-2" class="pilcrow">¶</a>
</div>
<p id="section-2.4-3">Salt values are used as input for DeriveBlindKey, DeriveKeyPair, and DeriveSalt.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.4-4">Salt values, including the original seed value, <span class="bcp14">MUST NOT</span> be reused outside of HDK.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-hdk-function">
<section id="section-2.5">
        <h3 id="name-the-hdk-function">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-the-hdk-function" class="section-name selfRef">The HDK function</a>
        </h3>
<p id="section-2.5-1">A local unit or a remote party deterministically computes an HDK from an index, a parent public key, a salt, and an optional parent blinding factor. The salt can be an initial seed value of <code>Ns</code> bytes or it can be taken from another parent HDK. The secure generation of the seed is out of scope for this specification.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.5-2">
<pre>
Inputs:
- index, an integer between 0 and 2^32-1 (inclusive).
- pk, a public key to be blinded.
- salt, a string of Ns bytes.
- bf, a blinding factor to combine with, if any, Nil otherwise.
- skD, a private key to be blinded, if known, Nil otherwise.

Outputs:
- pk', the blinded public key at the provided index.
- salt', the salt for HDK derivation at the provided index.
- bf', the blinding factor at the provided index.
- bk, the current blind key.
- ctx, the current key blinding application context byte string.
- sk', the blinded private key.

def HDK(index, pk, salt, bf = Nil, skD = Nil):
    ctx   = CreateContext(pk, index)
    salt' = DeriveSalt(salt, ctx)

    bk  = DeriveBlindKey(salt)
    pk' = BlindPublicKey(pk, bk, ctx)
    sk' = if   skD == Nil: Nil
          elif bf  == Nil: BlindPrivateKey(skD, bk, ctx)
          else           : BlindPrivateKey(Combine(skD, bf), bk, ctx)
    bf' = if   bf  == Nil: DeriveBlindingFactor(bk, ctx)
          else           : Combine(bf, DeriveBlindingFactor(bk, ctx))

    return ((pk', salt', bf'), (bk, ctx), sk')
</pre><a href="#section-2.5-2" class="pilcrow">¶</a>
</div>
<p id="section-2.5-3">A unit <span class="bcp14">MUST NOT</span> persist a blinded private key. Instead, if persistence is needed, a unit can persist either the blinding factor of each HDK, or a path consisting of the seed salt, indices and key handles. In both cases, the application of Combine in the HDK function enables reconstruction of the blinding factor with respect to the original private key, enabling application of for example BlindPrivateKey.<a href="#section-2.5-3" class="pilcrow">¶</a></p>
<p id="section-2.5-4">If the unit uses the blinded private key directly, the unit <span class="bcp14">MUST</span> use it within the secure cryptographic device protecting the device private key.<a href="#section-2.5-4" class="pilcrow">¶</a></p>
<p id="section-2.5-5">If the unit uses the blinded private key directly, the unit <span class="bcp14">MUST</span> ensure the secure cryptographic device deletes it securely from memory after usage.<a href="#section-2.5-5" class="pilcrow">¶</a></p>
<p id="section-2.5-6">When presenting multiple documents, a reader can require a proof that multiple keys are associated to a single device. Several protocols for a cryptographic proof of association are possible, such as <span>[<a href="#Verheul2024" class="cite xref">Verheul2024</a>]</span>. For example, a unit could prove in a zero-knowledge protocol knowledge of the association between two elliptic curve keys <code>B1 = [bf1]D</code> and <code>B2 = [bf2]D</code>, where <code>bf1</code> and <code>bf2</code> are multiplicative blinding factors for a common blinding public key <code>D</code>. In this protocol, the association is known by the discrete logarithm of <code>B2 = [bf2/bf1]B1</code> with respect to generator <code>B1</code>. The unit can apply Combine to obtain values to compute this association.<a href="#section-2.5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-local-hdk-procedure">
<section id="section-2.6">
        <h3 id="name-the-local-hdk-procedure">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-the-local-hdk-procedure" class="section-name selfRef">The local HDK procedure</a>
        </h3>
<p id="section-2.6-1">This is a procedure executed locally by a unit.<a href="#section-2.6-1" class="pilcrow">¶</a></p>
<p id="section-2.6-2">To begin, the unit securely generates a <code>seed</code> salt of <code>Ns</code> bytes and a device key pair:<a href="#section-2.6-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.6-3">
<pre>
seed = random(Ns) # specification of random out of scope
(skD, pkD) = GenerateKeyPair()
</pre><a href="#section-2.6-3" class="pilcrow">¶</a>
</div>
<p id="section-2.6-4">The unit <span class="bcp14">MUST</span> generate <code>skD</code> within a secure cryptographic device.<a href="#section-2.6-4" class="pilcrow">¶</a></p>
<p id="section-2.6-5">Whenever the unit requires the HDK with some <code>index</code> at level 0, the unit computes:<a href="#section-2.6-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.6-6">
<pre>
((pk, salt, bf), (bk, ctx), sk) = HDK(index, pkD, seed, Nil, sk)
</pre><a href="#section-2.6-6" class="pilcrow">¶</a>
</div>
<p id="section-2.6-7">Now the unit can use the blinded key pair <code>(sk, pk)</code> or derive child HDKeys.<a href="#section-2.6-7" class="pilcrow">¶</a></p>
<p id="section-2.6-8">Whenever the unit requires the HDK with some <code>index</code> at level <code>n &gt; 0</code> based on a parent HDK <code>(pk, salt, bf)</code> with blinded key pair <code>(sk, pk)</code> at level <code>n</code>, the unit computes:<a href="#section-2.6-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.6-9">
<pre>
((pk', salt', bf'), (bk, ctx), sk') = HDK(index, pk, salt, bf, sk)
</pre><a href="#section-2.6-9" class="pilcrow">¶</a>
</div>
<p id="section-2.6-10">Now the unit can use the blinded key pair <code>(sk', pk')</code> or derive child HDKeys.<a href="#section-2.6-10" class="pilcrow">¶</a></p>
<p id="section-2.6-11">Note that providing <code>sk</code> is optional. Alternatively, the unit can use the returned <code>bk</code> and <code>ctx</code> with the parent <code>bf</code> separately in a key blinding scheme, for example using:<a href="#section-2.6-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.6-12">
<pre>
sk' = BlindPrivateKey(Combine(sk, bf), bk, ctx)
</pre><a href="#section-2.6-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-remote-hdk-protocol">
<section id="section-2.7">
        <h3 id="name-the-remote-hdk-protocol">
<a href="#section-2.7" class="section-number selfRef">2.7. </a><a href="#name-the-remote-hdk-protocol" class="section-name selfRef">The remote HDK protocol</a>
        </h3>
<p id="section-2.7-1">This is a protocol between a local unit and a remote issuer.<a href="#section-2.7-1" class="pilcrow">¶</a></p>
<p id="section-2.7-2">As a prerequisite, the unit possesses a <code>salt</code> of <code>Ns</code> bytes associated with a parent key pair <code>(sk, pk)</code> with blinding factor <code>bf</code> (potentially <code>Nil</code>) generated using the local HDK procedure.<a href="#section-2.7-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.7-3">
<pre>
# 1. Unit computes:
(skR, pkR) = DeriveKeyPair(salt)

# 2. Unit shares with issuer: (pk, pkR)

# 3. Issuer computes:
(salt_kem, kh) = Encap(pkR)

# 4. Issuer shares with unit: kh

# Subsequently, for any index known to both parties:

# 5. Issuer computes:
((pk', salt', bf'), _, _) = HDK(index, pk, salt_kem)

# 6. Issuer shares with unit: pkA = pk'

# 7. Unit verifies integrity:
salt_kem = Decap(kh, skR)
((pk', salt', bf'), (bk, ctx), _) = HDK(index, pk, salt_kem, bf)
pk' == pkA

# 8. Unit computes:
sk' = BlindPrivateKey(Combine(sk, bf), bk, ctx) # optional
</pre><a href="#section-2.7-3" class="pilcrow">¶</a>
</div>
<p id="section-2.7-4">After step 7, the unit can use the value of <code>salt'</code> to derive next-level HDKeys.<a href="#section-2.7-4" class="pilcrow">¶</a></p>
<p id="section-2.7-5">Step 4 <span class="bcp14">MAY</span> be postponed to be combined with step 6. Steps 5 to 8 <span class="bcp14">MAY</span> be combined in concurrent execution for multiple indices.<a href="#section-2.7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-hdk-key-alias-format">
<section id="section-2.8">
        <h3 id="name-the-hdk-key-alias-format">
<a href="#section-2.8" class="section-number selfRef">2.8. </a><a href="#name-the-hdk-key-alias-format" class="section-name selfRef">The HDK key alias format</a>
        </h3>
<p id="section-2.8-1">An HDK can be represented canonically using the following string format, in augmented Backus-Naur form (ABNF) <span>[<a href="#RFC5234" class="cite xref">RFC5234</a>]</span> and applying non-padded base64url encoding <span>[<a href="#RFC4648" class="cite xref">RFC4648</a>]</span> for key handles:<a href="#section-2.8-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.8-2">
<pre>
hdk-key-alias  = origin-alias "/" path

; The origin-alias is an opaque identifier for a device
; key pair, the associated HDK instantiation, and the seed.
origin-alias   = 1*255no-slash

; The hdk-path identifies the indices and key handles to
; apply from left to right.
hdk-path       = hdk-index *("/" hdk-sub-path)

hdk-sub-path   = *(hdk-edge "/") hdk-index
hdk-edge       = ("#" hdk-key-handle) / hdk-index

; The index is to be parsed to an integer between 0 and
; 2^32-1 (inclusive) and used as input to CreateContext.
hdk-index      = non-zero-digit 0*9DIGIT

; The key handle is to be decoded from
hdk-key-handle = 1*base64url-char

no-slash       = %x21-%x2E / %x30-%x7E ; ASCII printable, no "/"
non-zero-digit = %31-39
base64url-char = ALPHA / DIGIT / "-" / "_"
</pre><a href="#section-2.8-2" class="pilcrow">¶</a>
</div>
<p id="section-2.8-3">A unit <span class="bcp14">MAY</span> use the HDK key alias format to represent keys internally.<a href="#section-2.8-3" class="pilcrow">¶</a></p>
<p id="section-2.8-4">A unit <span class="bcp14">MUST NOT</span> directly include the device private key in the <code>origin-alias</code>.<a href="#section-2.8-4" class="pilcrow">¶</a></p>
<p id="section-2.8-5">A unit <span class="bcp14">MUST NOT</span> directly include the seed in the <code>origin-alias</code>.<a href="#section-2.8-5" class="pilcrow">¶</a></p>
<p id="section-2.8-6">When taking input in the HDK key alias format:<a href="#section-2.8-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.8-7.1">
            <p id="section-2.8-7.1.1">a unit <span class="bcp14">MAY</span> pose further limitations on the value of <code>origin-alias</code>;<a href="#section-2.8-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.8-7.2">
            <p id="section-2.8-7.2.1">a unit <span class="bcp14">MUST</span> limit either the amount of <code>hdk-edge</code> instances or the total length of the <code>hdk-key-alias</code>;<a href="#section-2.8-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.8-7.3">
            <p id="section-2.8-7.3.1">a unit <span class="bcp14">MUST</span> verify that the byte strings represented by <code>hdk-key-handle</code> has the size of ciphertext in <code>KEM</code>.<a href="#section-2.8-7.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.8-8">Example key handles:<a href="#section-2.8-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.8-9">
<pre>
my_pid_key/0

my_pid_key/12345

my_pid_key/0/iS2ipkvGCDI0-Lps25Ex2KdjTfGRmIBjGEHkjBCPoQg/3

; newline for printing purposes not in the actual hdk-path
second_key/123/45/itnCVhZ-DYZDaUqofDNhHEbNc9XOrdnLL9B-9dVZ
tTg/6789/3JVRsML8NvUnCx1CvzpZrHSn4TkSUpGgn8r-X_RiQ1Y/3
</pre><a href="#section-2.8-9" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="generic-hdk-instantiations">
<section id="section-3">
      <h2 id="name-generic-hdk-instantiations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-generic-hdk-instantiations" class="section-name selfRef">Generic HDK instantiations</a>
      </h2>
<div id="using-digital-signatures">
<section id="section-3.1">
        <h3 id="name-using-digital-signatures">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-using-digital-signatures" class="section-name selfRef">Using digital signatures</a>
        </h3>
<p id="section-3.1-1">Instantiations of HDK using digital signatures require:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1"><code>DSA</code>: A digital signature algorithm, consisting of the functions:<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1.2.1">
                <p id="section-3.1-2.1.2.1.1">GenerateKeyPair(): Outputs a new key pair <code>(sk, pk)</code> consisting of private key <code>sk</code> and public key <code>pk</code>.<a href="#section-3.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.1.2.2">
                <p id="section-3.1-2.1.2.2.1">Sign(sk, msg): Outputs the signature created using private signing key <code>sk</code> over byte string <code>msg</code>.<a href="#section-3.1-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.1.2.3">
                <p id="section-3.1-2.1.2.3.1">Verify(signature, pk, msg): Outputs whether <code>signature</code> is a signature over <code>msg</code> using public verification key <code>pk</code>.<a href="#section-3.1-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-3.1-3">Using these constructs, an example proof of possession protocol is:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-4">
<pre>
# 1. Unit shares with reader: pk

# 2. Reader computes:
nonce = generate_random_nonce() # out of scope for this spec

# 3. Reader shares with unit: nonce

# 4. Unit computes:
msg = create_message(pk, nonce) # out of scope for this spec
signature = Sign(sk, msg)

# 5. Reader computes:
msg = create_message(pk, nonce) # out of scope for this spec
Verify(signature, pk, msg)
</pre><a href="#section-3.1-4" class="pilcrow">¶</a>
</div>
<p id="section-3.1-5">Instantiations of HDK using digital signatures provide:<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-6.1">
            <p id="section-3.1-6.1.1"><code>BL</code>: A cryptographic construct that extends <code>DSA</code> as specified in <span>[<a href="#I-D.draft-irtf-cfrg-signature-key-blinding-07" class="cite xref">I-D.draft-irtf-cfrg-signature-key-blinding-07</a>]</span>, implementing the interface from <span><a href="#instantiation-parameters" class="internal xref">Instantiation parameters</a> (<a href="#instantiation-parameters" class="auto internal xref">Section 2.2</a>)</span>, as well as:<a href="#section-3.1-6.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-6.1.2.1">
                <p id="section-3.1-6.1.2.1.1">BlindKeySign(sk, bk, ctx, msg): Outputs the result of signing a message <code>msg</code> using the private key <code>sk</code> with the private blind key <code>bk</code> and application context byte string <code>ctx</code> such that for key pair <code>(sk, pk)</code>:<a href="#section-3.1-6.1.2.1.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-6.1.2.1.2">
<pre>
Verify(  BlindKeySign(sk, bk, ctx, msg),
       BlindPublicKey(pk, bk, ctx))      == 1
</pre><a href="#section-3.1-6.1.2.1.2" class="pilcrow">¶</a>
</div>
</li>
            </ul>
</li>
        </ul>
<p id="section-3.1-7">By design of <code>BL</code>, the same proof of possession protocol can be used with blinded key pairs and BlindKeySign, in such a way that the reader does not recognise that key blinding was used.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">In the default implementation, BlindKeySign requires support from the secure cryptographic device protecting <code>sk</code>:<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-9">
<pre>
def BlindKeySign(sk, bk, ctx, msg):
    sk' = BlindPrivateKey(sk, bk, ctx)
    signature = Sign(sk', msg)
    return signature
</pre><a href="#section-3.1-9" class="pilcrow">¶</a>
</div>
<p id="section-3.1-10">In some cases, BlindKeySign can be implemented in an alternative, distributed way. An example will be provided for <span><a href="#using-ec-sdsa-signatures" class="internal xref">using EC-SDSA signatures</a> (<a href="#using-ec-sdsa-signatures" class="auto internal xref">Section 3.3.2</a>)</span>.<a href="#section-3.1-10" class="pilcrow">¶</a></p>
<p id="section-3.1-11">Applications <span class="bcp14">MUST</span> bind the message to be signed to the blinded public key. This mitigates attacks based on signature malleability. Several proof of possession protocols require including document data in the message, which includes the blinded public key indeed.<a href="#section-3.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="using-prime-order-groups">
<section id="section-3.2">
        <h3 id="name-using-prime-order-groups">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-using-prime-order-groups" class="section-name selfRef">Using prime-order groups</a>
        </h3>
<p id="section-3.2-1">Instantiations of HDK using prime-order groups require:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">
            <p id="section-3.2-2.1.1"><code>G</code>: A prime-order group as defined in <span>[<a href="#RFC9497" class="cite xref">RFC9497</a>]</span> with elements of type Element and scalars of type Scalar, consisting of the functions:<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1.2.1">
                <p id="section-3.2-2.1.2.1.1">RandomScalar(): Outputs a random Scalar <code>k</code>.<a href="#section-3.2-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2-2.1.2.2">
                <p id="section-3.2-2.1.2.2.1">Add(A, B): Outputs the sum between Elements <code>A</code> and <code>B</code>.<a href="#section-3.2-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2-2.1.2.3">
                <p id="section-3.2-2.1.2.3.1">ScalarMult(A, k): Outputs the scalar multiplication between Element <code>A</code> and Scalar <code>k</code>.<a href="#section-3.2-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2-2.1.2.4">
                <p id="section-3.2-2.1.2.4.1">ScalarBaseMult(k): Outputs the scalar multiplication between the base Element and Scalar <code>k</code>.<a href="#section-3.2-2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2-2.1.2.5">
                <p id="section-3.2-2.1.2.5.1">Order(): Outputs the order of the base Element.<a href="#section-3.2-2.1.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2-2.1.2.6">
                <p id="section-3.2-2.1.2.6.1">SerializeScalar(k): Outputs a byte string representing Scalar <code>k</code>.`<a href="#section-3.2-2.1.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2-2.1.2.7">
                <p id="section-3.2-2.1.2.7.1">HashToScalar(msg): Outputs the result of deterministically mapping a byte string <code>msg</code> to an element in the scalar field of the prime order subgroup of <code>G</code>, using the <code>hash_to_field</code> function from a hash-to-curve suite <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#section-3.2-2.1.2.7.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-3.2-3">Instantiations of HDK using prime-order groups provide:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-4">
<pre>
def GenerateKeyPair():
    sk = GenerateRandomScalar()
    pk = ScalarBaseMult(sk)
    return (sk, pk)

def DeriveBlindKey(ikm):
    bk_scalar = HashToScalar(ikm)
    bk = SerializeScalar(bk_scalar)
    return bk

def DeriveBlindingFactor(bk, ctx):
    msg = bk || 0x00 || ctx
    bf = HashToScalar(msg)
    return bf
</pre><a href="#section-3.2-4" class="pilcrow">¶</a>
</div>
<p id="section-3.2-5">Note that DeriveBlindKey and DeriveBlindingFactor are compatible with the definitions in <span>[<a href="#I-D.draft-irtf-cfrg-signature-key-blinding-07" class="cite xref">I-D.draft-irtf-cfrg-signature-key-blinding-07</a>]</span>. We illustrate also what would be needed instead for full compatibility with <span>[<a href="#I-D.draft-bradleylundberg-cfrg-arkg-02" class="cite xref">I-D.draft-bradleylundberg-cfrg-arkg-02</a>]</span> below and when <span><a href="#using-elliptic-curves" class="internal xref">Using elliptic curves</a> (<a href="#using-elliptic-curves" class="auto internal xref">Section 3.3</a>)</span>:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-6">
<pre>
def DeriveBlindKey_ARKG(ikm):
    # There is no need for additional processing,
    # since bk is in ARKG as intermediate input
    # for a pseudo-random function only.
    bk = ikm
    return bk
</pre><a href="#section-3.2-6" class="pilcrow">¶</a>
</div>
<div id="using-additive-blinding">
<section id="section-3.2.1">
          <h4 id="name-using-additive-blinding">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-using-additive-blinding" class="section-name selfRef">Using additive blinding</a>
          </h4>
<p id="section-3.2.1-1">Instantiations of HDK using additive blinding use:<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-2.1">
              <p id="section-3.2.1-2.1.1"><span><a href="#using-prime-order-groups" class="internal xref">prime-order groups</a> (<a href="#using-prime-order-groups" class="auto internal xref">Section 3.2</a>)</span><a href="#section-3.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.2.1-3">Instantiations of HDK using additive blinding provide:<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.1-4">
<pre>
def BlindPublicKey(pk, bk, ctx):
    bf = DeriveBlindingFactor(bk, ctx)
    pk' = Add(pk, ScalarBaseMult(bf))
    return pk

def BlindPrivateKey(sk, bk, ctx):
    bf = DeriveBlindingFactor(bk, ctx)
    sk' = sk + bf mod Order()
    if sk' == 0: abort with an error
    return sk

def Combine(bf1, bf2):
    bf = bf1 + bf2 mod Order()
    return bf
</pre><a href="#section-3.2.1-4" class="pilcrow">¶</a>
</div>
<p id="section-3.2.1-5">Note that all algorithms in <span>[<a href="#I-D.draft-bradleylundberg-cfrg-arkg-02" class="cite xref">I-D.draft-bradleylundberg-cfrg-arkg-02</a>]</span> use additive blinding.<a href="#section-3.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="using-multiplicative-blinding">
<section id="section-3.2.2">
          <h4 id="name-using-multiplicative-blindi">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-using-multiplicative-blindi" class="section-name selfRef">Using multiplicative blinding</a>
          </h4>
<p id="section-3.2.2-1">Instantiations of HDK using multiplicative blinding use:<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-2.1">
              <p id="section-3.2.2-2.1.1"><span><a href="#using-prime-order-groups" class="internal xref">prime-order groups</a> (<a href="#using-prime-order-groups" class="auto internal xref">Section 3.2</a>)</span><a href="#section-3.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.2.2-3">Instantiations of HDK using multiplicative blinding provide:<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2.2-4">
<pre>
def BlindPublicKey(pk, bk, ctx):
    bf = DeriveBlindingFactor(bk, ctx)
    pk' = ScalarMult(pk, bf)
    return pk

def BlindPrivateKey(sk, bk, ctx):
    bf = DeriveBlindingFactor(bk, ctx)
    sk' = sk * bf mod Order()
    if sk' == 1: abort with an error
    return sk

def Combine(bf1, bf2):
    bf = bf1 * bf2 mod Order()
    return bf
</pre><a href="#section-3.2.2-4" class="pilcrow">¶</a>
</div>
<p id="section-3.2.2-5">Note that all algorithms in <span>[<a href="#I-D.draft-irtf-cfrg-signature-key-blinding-07" class="cite xref">I-D.draft-irtf-cfrg-signature-key-blinding-07</a>]</span> use multiplicative blinding.<a href="#section-3.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="using-elliptic-curves">
<section id="section-3.3">
        <h3 id="name-using-elliptic-curves">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-using-elliptic-curves" class="section-name selfRef">Using elliptic curves</a>
        </h3>
<p id="section-3.3-1">Instantiations of HDK using elliptic curves use:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-2.1">
            <p id="section-3.3-2.1.1"><span><a href="#using-prime-order-groups" class="internal xref">prime-order groups</a> (<a href="#using-prime-order-groups" class="auto internal xref">Section 3.2</a>)</span><a href="#section-3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-3">Instantiations of HDK using elliptic curves require:<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-4.1">
            <p id="section-3.3-4.1.1"><code>DST</code>: A domain separation tag for use with HashToScalar.<a href="#section-3.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-4.2">
            <p id="section-3.3-4.2.1"><code>H2C</code>: A hash-to-curve suite <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#section-3.3-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-5">Instantiations of HDK using elliptic curves provide:<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-6.1">
            <p id="section-3.3-6.1.1"><code>H</code>: <code>H</code> from <code>H2C</code>.<a href="#section-3.3-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-6.2">
            <p id="section-3.3-6.2.1"><code>Ns</code>: The output size of <code>H</code>.<a href="#section-3.3-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-3.3-7">
<pre>
def HashToScalar(msg):
    scalar = hash_to_field(msg, 1) with the parameters:
        DST: DST
        F: GF(Order()), the scalar field
            of the prime order subgroup of EC
        p: Order()
        m: 1
        L: as defined in H2C
        expand_message: as defined in H2C
    return scalar
</pre><a href="#section-3.3-7" class="pilcrow">¶</a>
</div>
<p id="section-3.3-8">We illustrate also what would be needed instead for full compatibility with <span>[<a href="#I-D.draft-bradleylundberg-cfrg-arkg-02" class="cite xref">I-D.draft-bradleylundberg-cfrg-arkg-02</a>]</span> below:<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-9">
<pre>
def DeriveBlindingFactor_ARKG(bk, ctx):
    bf = HashToScalar_ARKG(msg, ctx)
    return bf

def HashToScalar_ARKG(msg, info):
    scalar = hash_to_field(msg, 1) with the parameters:
        DST: DST || info
        F: GF(Order()), the scalar field
            of the prime order subgroup of EC
        p: Order()
        m: 1
        L: as defined in H2C
        expand_message: as defined in H2C
    return scalar
</pre><a href="#section-3.3-9" class="pilcrow">¶</a>
</div>
<div id="using-ecdh-shared-secrets">
<section id="section-3.3.1">
          <h4 id="name-using-ecdh-shared-secrets">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-using-ecdh-shared-secrets" class="section-name selfRef">Using ECDH shared secrets</a>
          </h4>
<p id="section-3.3.1-1">Instantiations of HDK using ECDH shared secrets use:<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-2.1">
              <p id="section-3.3.1-2.1.1"><span><a href="#using-elliptic-curves" class="internal xref">elliptic curves</a> (<a href="#using-elliptic-curves" class="auto internal xref">Section 3.3</a>)</span><a href="#section-3.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.1-2.2">
              <p id="section-3.3.1-2.2.1"><span><a href="#using-multiplicative-blinding" class="internal xref">multiplicative blinding</a> (<a href="#using-multiplicative-blinding" class="auto internal xref">Section 3.2.2</a>)</span><a href="#section-3.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.1-3">Instantiations of HDK using ECDH shared secrets provide:<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-4.1">
              <p id="section-3.3.1-4.1.1"><code>DH</code>: The Elliptic Curve Key Agreement Algorithm - Diffie-Hellman (ECKA-DH) <span>[<a href="#TR03111" class="cite xref">TR03111</a>]</span> with elliptic curve <code>G</code>, consisting of the functions:<a href="#section-3.3.1-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-4.1.2.1">
                  <p id="section-3.3.1-4.1.2.1.1">CreateSharedSecret(skX, pkY): Outputs a shared secret byte string <code>Z_AB</code> representing the x-coordinate of the Element <code>ScalarMult(pkY, skX)</code>.<a href="#section-3.3.1-4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-3.3.1-5">Note that DH enables an alternative way of authenticating a key pair <code>(sk, pk)</code> without creation or verification of a signature:<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3.1-6">
<pre>
# 1. Unit shares with reader: pk

# 2. Reader computes:
(skR, pkR) = GenerateKeyPair()

# 3. Reader shares with unit: pkR

# 4. Unit computes:
Z_AB = CreateSharedSecret(sk, pkR)

# 5. Reader computes:
Z_AB = CreateSharedSecret(skR, pk)
</pre><a href="#section-3.3.1-6" class="pilcrow">¶</a>
</div>
<p id="section-3.3.1-7">Now with the shared secret <code>Z_AB</code>, the unit and the reader can compute a secret shared key. The unit can convince the reader that it possesses <code>sk</code> for example by sharing a message authentication code created using this key. The reader can verify this by recomputing the code using its value of <code>Z_AB</code>. This is for example used in ECDH-MAC authentication defined in <span>[<a href="#ISO18013-5" class="cite xref">ISO18013-5</a>]</span>.<a href="#section-3.3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.3.1-8">In this example, step 1 can be postponed in the interactions between the unit and the reader if a trustworthy earlier commitment to <code>pk</code> is available, for example in a sealed document.<a href="#section-3.3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.3.1-9">Similarly, ECDH enables authentication of key pair <code>(sk', pk')</code> blinded from an original key pair <code>(sk, pk)</code> using a blind key <code>ctx</code> and application context byte string <code>ctx</code> such that:<a href="#section-3.3.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3.1-10">
<pre>
bf = DeriveBlindingFactor(bk, ctx)
sk' = BlindPrivateKey(sk, bk, ctx)
    = sk * bf mod Order()
pk' = ScalarMult(pk, bf)
</pre><a href="#section-3.3.1-10" class="pilcrow">¶</a>
</div>
<p id="section-3.3.1-11">In this case, the computation in step 4 can be performed as such:<a href="#section-3.3.1-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3.1-12">
<pre>
# 4. Unit computes:
Z_AB = CreateSharedSecret(sk', pkR)
     = CreateSharedSecret(sk * bf mod Order(), pkR)
     = CreateSharedSecret(sk, ScalarMult(pkR, bf))
</pre><a href="#section-3.3.1-12" class="pilcrow">¶</a>
</div>
<p id="section-3.3.1-13">Note that the value of <code>ScalarMult(pkR, bf)</code> does not need to be computed within the secure cryptographic device that protects <code>sk</code>.<a href="#section-3.3.1-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="using-ec-sdsa-signatures">
<section id="section-3.3.2">
          <h4 id="name-using-ec-sdsa-signatures">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-using-ec-sdsa-signatures" class="section-name selfRef">Using EC-SDSA signatures</a>
          </h4>
<p id="section-3.3.2-1">Instantiations of HDK using EC-SDSA (Schnorr) signatures use:<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2-2.1">
              <p id="section-3.3.2-2.1.1"><span><a href="#using-additive-blinding" class="internal xref">additive blinding</a> (<a href="#using-additive-blinding" class="auto internal xref">Section 3.2.1</a>)</span><a href="#section-3.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.2-2.2">
              <p id="section-3.3.2-2.2.1"><span><a href="#using-digital-signatures" class="internal xref">digital signatures</a> (<a href="#using-digital-signatures" class="auto internal xref">Section 3.1</a>)</span><a href="#section-3.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.2-2.3">
              <p id="section-3.3.2-2.3.1"><span><a href="#using-elliptic-curves" class="internal xref">elliptic curves</a> (<a href="#using-elliptic-curves" class="auto internal xref">Section 3.3</a>)</span><a href="#section-3.3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.2-3">Instantiations of HDK using EC-SDSA signatures provide:<a href="#section-3.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2-4.1">
              <p id="section-3.3.2-4.1.1"><code>DSA</code>: An EC-SDSA digital signature algorithm <span>[<a href="#TR03111" class="cite xref">TR03111</a>]</span>, representing signatures as pairs <code>(c, s)</code>.<a href="#section-3.3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.2-5">Note that in this case, the following definition is equivalent to the <span><a href="#using-digital-signatures" class="internal xref">original definition of BlindKeySign</a> (<a href="#using-digital-signatures" class="auto internal xref">Section 3.1</a>)</span>:<a href="#section-3.3.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3.2-6">
<pre>
def BlindKeySign(sk, bk, ctx, msg):
    # Compute signature within the secure cryptographic device.
    (c, s) = Sign(sk, msg)

    # Post-process the signature outside of this device.
    bf = DeriveBlindingFactor(bk, ctx)
    s' = s + c * bf mod Order()

    signature = (c, s')
    return signature
</pre><a href="#section-3.3.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="using-p-256">
<section id="section-3.3.3">
          <h4 id="name-using-p-256">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-using-p-256" class="section-name selfRef">Using P-256</a>
          </h4>
<p id="section-3.3.3-1">Instantiations of HDK using P-256 use:<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.3-2.1">
              <p id="section-3.3.3-2.1.1"><span><a href="#using-elliptic-curves" class="internal xref">elliptic curves</a> (<a href="#using-elliptic-curves" class="auto internal xref">Section 3.3</a>)</span><a href="#section-3.3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.3-3">Instantiations of HDK using P-256 provide:<a href="#section-3.3.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.3-4.1">
              <p id="section-3.3.3-4.1.1"><code>G</code>: The NIST curve <code>secp256r1</code> (P-256) <span>[<a href="#SEC2" class="cite xref">SEC2</a>]</span>.<a href="#section-3.3.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.3-4.2">
              <p id="section-3.3.3-4.2.1"><code>H2C</code>: P256<em>XMD:SHA-256_SSWU_RO</em> <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>, which uses SHA-256 <span>[<a href="#FIPS180-4" class="cite xref">FIPS180-4</a>]</span> as <code>H</code>.<a href="#section-3.3.3-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.3-4.3">
              <p id="section-3.3.3-4.3.1"><code>KEM</code>: DHKEM(P-256, HKDF-SHA256) <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-3.3.3-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="concrete-hdk-instantiations">
<section id="section-4">
      <h2 id="name-concrete-hdk-instantiations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-concrete-hdk-instantiations" class="section-name selfRef">Concrete HDK instantiations</a>
      </h2>
<p id="section-4-1">The <span class="bcp14">RECOMMENDED</span> instantiation is the HDK-ECDH-P256. This avoids the risk of having the holder unknowingly producing a potentially non-repudiable signature over reader-provided data. Secure cryptographic devices that enable a high level of assurance typically support managing ECDH keys with the P-256 elliptic curve.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="hdk-ecdh-p256">
<section id="section-4.1">
        <h3 id="name-hdk-ecdh-p256">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-hdk-ecdh-p256" class="section-name selfRef">HDK-ECDH-P256</a>
        </h3>
<p id="section-4.1-1">The HDK-ECDH-P256 instantiation of HDK uses:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1"><span><a href="#using-p-256" class="internal xref">P-256</a> (<a href="#using-p-256" class="auto internal xref">Section 3.3.3</a>)</span><a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1"><span><a href="#using-ecdh-shared-secrets" class="internal xref">ECDH shared secrets</a> (<a href="#using-ecdh-shared-secrets" class="auto internal xref">Section 3.3.1</a>)</span><a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-3">The HDK-ECDH-P256 instantiation defines:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-4.1">
            <p id="section-4.1-4.1.1"><code>DST</code>: <code>"ECDH Key Blind"</code><a href="#section-4.1-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="hdk-ecdsa-p256add">
<section id="section-4.2">
        <h3 id="name-hdk-ecdsa-p256add">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-hdk-ecdsa-p256add" class="section-name selfRef">HDK-ECDSA-P256add</a>
        </h3>
<p id="section-4.2-1">The HDK-ECDSA-P256add instantiation of HDK uses:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">
            <p id="section-4.2-2.1.1"><span><a href="#using-digital-signatures" class="internal xref">digital signatures</a> (<a href="#using-digital-signatures" class="auto internal xref">Section 3.1</a>)</span><a href="#section-4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.2">
            <p id="section-4.2-2.2.1"><span><a href="#using-p-256" class="internal xref">P-256</a> (<a href="#using-p-256" class="auto internal xref">Section 3.3.3</a>)</span><a href="#section-4.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.3">
            <p id="section-4.2-2.3.1"><span><a href="#using-additive-blinding" class="internal xref">additive blinding</a> (<a href="#using-additive-blinding" class="auto internal xref">Section 3.2.1</a>)</span><a href="#section-4.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.2-3">The HDK-ECDSA-P256add instantiation of HDK defines:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-4.1">
            <p id="section-4.2-4.1.1"><code>DST</code>: <code>"ARKG-BL-EC.ARKG-P256ADD-ECDH"</code> for interoperability with <span>[<a href="#I-D.draft-bradleylundberg-cfrg-arkg-02" class="cite xref">I-D.draft-bradleylundberg-cfrg-arkg-02</a>]</span>.<a href="#section-4.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-4.2">
            <p id="section-4.2-4.2.1"><code>DSA</code>: ECDSA <span>[<a href="#TR03111" class="cite xref">TR03111</a>]</span> with curve <code>G</code>.<a href="#section-4.2-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="hdk-ecdsa-p256mul">
<section id="section-4.3">
        <h3 id="name-hdk-ecdsa-p256mul">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-hdk-ecdsa-p256mul" class="section-name selfRef">HDK-ECDSA-P256mul</a>
        </h3>
<p id="section-4.3-1">The HDK-ECDSA-P256mul instantiation of HDK uses:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.1">
            <p id="section-4.3-2.1.1"><span><a href="#using-digital-signatures" class="internal xref">digital signatures</a> (<a href="#using-digital-signatures" class="auto internal xref">Section 3.1</a>)</span><a href="#section-4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.2">
            <p id="section-4.3-2.2.1"><span><a href="#using-p-256" class="internal xref">P-256</a> (<a href="#using-p-256" class="auto internal xref">Section 3.3.3</a>)</span><a href="#section-4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.3">
            <p id="section-4.3-2.3.1"><span><a href="#using-multiplicative-blinding" class="internal xref">multiplicative blinding</a> (<a href="#using-multiplicative-blinding" class="auto internal xref">Section 3.2.2</a>)</span><a href="#section-4.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-3">The HDK-ECDSA-P256mul instantiation of HDK defines:<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-4.1">
            <p id="section-4.3-4.1.1"><code>DST</code>: <code>"ECDSA Key Blind"</code> for interoperability with <span>[<a href="#I-D.draft-irtf-cfrg-signature-key-blinding-07" class="cite xref">I-D.draft-irtf-cfrg-signature-key-blinding-07</a>]</span>.<a href="#section-4.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-4.2">
            <p id="section-4.3-4.2.1"><code>DSA</code>: ECDSA <span>[<a href="#TR03111" class="cite xref">TR03111</a>]</span> with curve <code>G</code>.<a href="#section-4.3-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="hdk-ecsdsa-p256">
<section id="section-4.4">
        <h3 id="name-hdk-ecsdsa-p256">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-hdk-ecsdsa-p256" class="section-name selfRef">HDK-ECSDSA-P256</a>
        </h3>
<p id="section-4.4-1">The HDK-ECSDSA-P256 instantiation of HDK uses:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">
            <p id="section-4.4-2.1.1"><span><a href="#using-ec-sdsa-signatures" class="internal xref">EC-SDSA signatures</a> (<a href="#using-ec-sdsa-signatures" class="auto internal xref">Section 3.3.2</a>)</span><a href="#section-4.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-2.2">
            <p id="section-4.4-2.2.1"><span><a href="#using-p-256" class="internal xref">P-256</a> (<a href="#using-p-256" class="auto internal xref">Section 3.3.3</a>)</span><a href="#section-4.4-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.4-3">The HDK-ECSDSA-P256 instantiation of HDK defines:<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-4.1">
            <p id="section-4.4-4.1.1"><code>DST</code>: <code>"EC-SDSA Key Blind"</code><a href="#section-4.4-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="application-considerations">
<section id="section-5">
      <h2 id="name-application-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-application-considerations" class="section-name selfRef">Application considerations</a>
      </h2>
<div id="secure-cryptographic-device">
<section id="section-5.1">
        <h3 id="name-secure-cryptographic-device">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-secure-cryptographic-device" class="section-name selfRef">Secure cryptographic device</a>
        </h3>
<p id="section-5.1-1">The HDK approach assumes that the holder controls a secure cryptographic device that protects the device key pair <code>(sk_device, pk_device)</code>. The device key is under sole control of the holder.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">In the context of <span>[<a href="#EU2024-1183" class="cite xref">EU2024-1183</a>]</span>, this device is typically called a Wallet Secure Cryptographic Device (WSCD), running a personalised Wallet Secure Cryptographic Application (WSCA) that exposes a Secure Cryptographic Interface (SCI) to a Wallet Instance (WI) running on a User Device (UD). The WSCD is certified to protect access to the device private key with high attack potential resistance to achieve high level of assurance authentication as per <span>[<a href="#EU2015-1502" class="cite xref">EU2015-1502</a>]</span>. This typically means that the key is associated with a strong possession factor and with a rate-limited Personal Identification Number (PIN) check as a knowledge factor, and the verification of both factors actively involve the WSCD.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">An example deployment of HDK in this context is illustrated below.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-4">
<pre>
+---------------------+          +----------------------+
|Issuer infrastructure|          |User Device (UD)      |
|                     |          |                      |
|+-------------------+|OpenID4VCI|+--------------------+|
||Issuer service     |&lt;----------++Wallet Instance (WI)||
||                   ||          |++-------------------+|
||Optionally an      ||          +-+--------------------+
||ARKG subordinate   ||            |Secure
||party              ||            |Cryptographic
|+-------------------+|            |Interface (SCI)
+---------------------+           +v-------------------+
                                  |Wallet Secure       |
                                  |Cryptographic       |
          Internal     Manages    |Application (WSCA)  |
          registry    &lt;-----------+                    |
                                  |Optionally an       |
                                  |ARKG delegating     |
                                  |party               |
                                  ++-------------------+
                                   |Uses
                                  +v-------------------+
                       Protects   |Wallet secure       |
          Device keys &lt;-----------+cryptographic       |
                                  |device (WSCD)       |
                                  +--------------------+
</pre><a href="#section-5.1-4" class="pilcrow">¶</a>
</div>
<p id="section-5.1-5">The WSCA could be a single program or could be deployed in a distributed architecture, as illustrated below.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-6">
<pre>
+--------------+
|User device   |
|+------------+|
||WI          ||
|++-----------+|
| |SCI         |
|+v-----------+|
||WSCA agent  ||
|++-----------+|
+-+------------+
  |WSCA protocol
 +v-----------+
 |WSCA service|
 +------------+
</pre><a href="#section-5.1-6" class="pilcrow">¶</a>
</div>
<p id="section-5.1-7">In the case of a distributed WSCA, the UD contains a local component, here called WSCA agent, accessing an external and possibly remote WSCA service from one or more components over a WSCA protocol. For example, the WSCA agent may be a local web API client and the WSCA service may be provided at a remote web API server. In such cases, typically the WSCA service receives a high-assurance security evaluation, while the WSCA agent is assessed to not be able to compromise the system's security guarantees.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">The internal registry can be managed by the WSCA agent, by the WSCA service, or by the combination. When the user device is a natural person’s mobile phone, WSCA agent management could provide better confidentiality protection against compromised WSCA service providers. When the user device is a cloud server used by a legal person, and the legal person deploys its own WSCD, WSCA service management could provide better confidentiality protection against compromised Wallet Instance cloud providers.<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<p id="section-5.1-9">In a distributed WSCA architecture, the WSCA could internally apply distributed key generation. A description of this is out of scope for the current document.<a href="#section-5.1-9" class="pilcrow">¶</a></p>
<p id="section-5.1-10">The solution proposal discussed herein works in all any WSCD architecture that supports the required cryptographic primitives:<a href="#section-5.1-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-11.1">
            <p id="section-5.1-11.1.1">In the case of HDK-ECDH-P256 (see <a href="#hdk-ecdh-p256" class="auto internal xref">Section 4.1</a>):<a href="#section-5.1-11.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-11.1.2.1">
                <p id="section-5.1-11.1.2.1.1">P-256 ECDH key pair generation<a href="#section-5.1-11.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1-11.1.2.2">
                <p id="section-5.1-11.1.2.2.1">P-256 ECDH key agreement<a href="#section-5.1-11.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-5.1-11.2">
            <p id="section-5.1-11.2.1">In the case of HDK-ECDSA-P256mul (see <a href="#hdk-ecdsa-p256mul" class="auto internal xref">Section 4.3</a>):<a href="#section-5.1-11.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-11.2.2.1">
                <p id="section-5.1-11.2.2.1.1">P-256 ECDSA blinding key pair generation<a href="#section-5.1-11.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1-11.2.2.2">
                <p id="section-5.1-11.2.2.2.1">P-256 ECDSA blinded signature creation<a href="#section-5.1-11.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-5.1-11.3">
            <p id="section-5.1-11.3.1">In the case of HDK-ECSDSA-P256 (see <a href="#hdk-ecsdsa-p256" class="auto internal xref">Section 4.4</a>):<a href="#section-5.1-11.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-11.3.2.1">
                <p id="section-5.1-11.3.2.1.1">P-256 EC-SDSA key pair generation<a href="#section-5.1-11.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1-11.3.2.2">
                <p id="section-5.1-11.3.2.2.1">P-256 EC-SDSA signature creation<a href="#section-5.1-11.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-5.1-12">The other HDK operations can be performed in a WSCA or WSCA agent running on any UD, including hostile ones with limited sandboxing capabilities, such as in a smartphone's rich execution environment or in a personal computer web browser.<a href="#section-5.1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-evidence">
<section id="section-5.2">
        <h3 id="name-trust-evidence">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-trust-evidence" class="section-name selfRef">Trust evidence</a>
        </h3>
<p id="section-5.2-1">Some issuers could require evidence from a solution provider of the security of the holder's cryptographic device. This evidence can in the context of <span>[<a href="#EU2024-1183" class="cite xref">EU2024-1183</a>]</span> be divided into initial "Wallet Trust Evidence" and related "Issuer Trust Evidence". Each is a protected document that contains a trust evidence public key associated with a private key that is protected in the secure cryptographic device. With HDK, these public keys are specified as follows.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="wallet-trust-evidence">
<section id="section-5.2.1">
          <h4 id="name-wallet-trust-evidence">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-wallet-trust-evidence" class="section-name selfRef">Wallet Trust Evidence</a>
          </h4>
<p id="section-5.2.1-1">The Wallet Trust Evidence public key is the first level 0 HDK public key. To achieve reader unlinkability, the wallet <span class="bcp14">SHOULD</span> limit access to a trusted person identification document provider only.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">To prevent association across identities, the solution provider <span class="bcp14">MUST</span> before issuing Wallet Trust Evidence ensure that (a) a newly generated device key pair is used and (b) the wallet follows the protocol so that the HDK output is bound to exactly this key. For (a), the solution provider could rely on freshness of a key attestation and ensure that each device public key is attested only once. For (b), the wallet could proof knowledge of the blinding factor <code>bf</code> with a Schnorr non-interactive zero-knowledge proof <span>[<a href="#RFC8235" class="cite xref">RFC8235</a>]</span> with base point <code>pk_device</code>. This would ensure that the root blinding key <code>bf</code> is not shared with the solution provider to reduce the risk of the solution provider unblinding future derived keys.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-trust-evidence">
<section id="section-5.2.2">
          <h4 id="name-issuer-trust-evidence">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-issuer-trust-evidence" class="section-name selfRef">Issuer Trust Evidence</a>
          </h4>
<p id="section-5.2.2-1">The Issuer Trust Evidence public key can be any other HDK public key. The solution provider <span class="bcp14">MUST</span> verify that the wallet knows the associated private key before issuing Issuer Trust Evidence. The solution provider <span class="bcp14">MUST</span> ensure that <code>sk_device</code> is under sole control of the unit holder. To achieve reader unlinkability, the unit <span class="bcp14">MUST</span> limit access of Issuer Trust Evidence to a single issuer. Subsequent issuers within the same HDK tree do not need to receive any Issuer Trust Evidence, since they can derive equally secure keys by applying the remote HDK protocol to presented keys attested by trusted (other) issuers.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="applying-hdk-in-openid-for-verifiable-credential-issuance">
<section id="section-5.3">
        <h3 id="name-applying-hdk-in-openid-for-">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-applying-hdk-in-openid-for-" class="section-name selfRef">Applying HDK in OpenID for Verifiable Credential Issuance</a>
        </h3>
<p id="section-5.3-1">In <span>[<a href="#draft-OpenID4VCI" class="cite xref">draft-OpenID4VCI</a>]</span>, the following terminology applies:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">OpenID4VCI</th>
              <th class="text-left" rowspan="1" colspan="1">HDK</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Credential</td>
              <td class="text-left" rowspan="1" colspan="1">document</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Credential Issuer</td>
              <td class="text-left" rowspan="1" colspan="1">issuer</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Verifier</td>
              <td class="text-left" rowspan="1" colspan="1">reader</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Wallet</td>
              <td class="text-left" rowspan="1" colspan="1">unit</td>
            </tr>
          </tbody>
        </table>
<p id="section-5.3-3">HDK enables unit and issuers cooperatively to establish the cryptographic key material that issued documents will be bound to.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">For the remote HDK protocol, HDK proposes an update to the OpenID4VCI endpoints. This proposal is under discussion in <a href="https://github.com/openid/OpenID4VCI/issues/359">openid/OpenID4VCI#359</a>. In the update, the unit shares a key encapsulation public key with the issuer, and the issuer returns a key handle. Then documents can be re-issued, potentially in batches, using synchronised indices. Alternatively, re-issued documents can have their own key handles.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="applying-hdk-with-arkg">
<section id="section-5.4">
        <h3 id="name-applying-hdk-with-arkg">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-applying-hdk-with-arkg" class="section-name selfRef">Applying HDK with ARKG</a>
        </h3>
<p id="section-5.4-1">This section illustrates how an Asynchronous Remote Key Generation (ARKG) instance can be constructed using the interfaces from the current document. It is not fully compatible with <span>[<a href="#I-D.draft-bradleylundberg-cfrg-arkg-02" class="cite xref">I-D.draft-bradleylundberg-cfrg-arkg-02</a>]</span> due to subtle differences, such as those in <span><a href="#using-prime-order-groups" class="internal xref">Using prime-order groups</a> (<a href="#using-prime-order-groups" class="auto internal xref">Section 3.2</a>)</span> and <span><a href="#using-elliptic-curves" class="internal xref">Using elliptic curves</a> (<a href="#using-elliptic-curves" class="auto internal xref">Section 3.3</a>)</span>.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4-2">
<pre>
def DeriveSeed(ikm, (skD, bf), pk):
    (skR, pkR) = DeriveKeyPair(ikm)
    skA = (skR, (skD, bf, pk))
    pkA = (pkR, pk)
    return (skA, pkA)

def DerivePublicKey((pkR, pk), index):
    (salt_kem, kh) = Encap(pkR)

    bk  = DeriveBlindKey(salt_kem)
    ctx = CreateContext(pk, index)
    pk' = BlindPublicKey(pk, bk, ctx)

    return (pk', kh)

def DerivePrivateKey((skR, (skD, bf, pk)), (pk', kh), index):
    salt_kem = Decap(kh, skR)

    bk  = DeriveBlindKey(salt_kem)
    ctx = CreateContext(pk, index)
    pkE = BlindPublicKey(pk, bk, ctx)

    if pk' != pkE: abort with an error

    sk  = Combine(skD, bf)
    sk' = BlindPrivateKey(sk, bk, ctx)

    return sk'
</pre><a href="#section-5.4-2" class="pilcrow">¶</a>
</div>
<p id="section-5.4-3">This enables the <span><a href="#the-remote-hdk-protocol" class="internal xref">remote HDK protocol</a> (<a href="#the-remote-hdk-protocol" class="auto internal xref">Section 2.7</a>)</span> to be performed as such, given an <code>index</code> known to both parties:<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4-4">
<pre>
# 1. Unit computes:
(skA, pkA) = DeriveSeed(salt, (skD, bf), pk)

# 2. Unit shares with issuer: pkA

# 3. Issuer computes:
(pk', kh) = DerivePublicKey(pkA, index)

# 4. Issuer shares with unit: (pk', kh)

# 5. Unit verifies integrity and computes the private key:
sk' = DerivePrivateKey(skA, (pk', kh), index)
</pre><a href="#section-5.4-4" class="pilcrow">¶</a>
</div>
<p id="section-5.4-5">For using a single <code>kh</code> with multiple values of <code>index</code>, the DerivePublicKey needs to be refactored to be able to reuse the Encap output.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security considerations</a>
      </h2>
<div id="confidentiality-of-key-handles">
<section id="section-6.1">
        <h3 id="name-confidentiality-of-key-hand">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-confidentiality-of-key-hand" class="section-name selfRef">Confidentiality of key handles</a>
        </h3>
<p id="section-6.1-1">The key handles <span class="bcp14">MUST</span> be considered confidential, since they provide knowledge about the blinding factors. Compromise of this knowledge could introduce undesired linkability. In HDK, both the holder and the issuer know the key handle during issuance.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">In an alternative to HDK, the holder independently generates blinded key pairs and proofs of association, providing the issuer with zero knowledge about the blinding factors. However, this moves the problem: the proofs of association would now need to be considered confidential.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="FIPS180-4">[FIPS180-4]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"Secure Hash Standard (SHS)"</span>, <span class="seriesInfo">FIPS 180-4</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.180-4</span>, <time datetime="2012-06" class="refDate">June 2012</time>, <span>&lt;<a href="https://csrc.nist.gov/pubs/fips/180-4/upd1/final">https://csrc.nist.gov/pubs/fips/180-4/upd1/final</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO18013-5">[ISO18013-5]</dt>
        <dd>
<span class="refAuthor">ISO/IEC</span>, <span class="refTitle">"Personal identification - ISO-compliant driving licence - Part 5: Mobile driving licence (mDL) application"</span>, <span class="seriesInfo">ISO/IEC 18013-5:2021</span>, <time datetime="2019-09" class="refDate">September 2019</time>, <span>&lt;<a href="https://www.iso.org/standard/69084.html">https://www.iso.org/standard/69084.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8017">https://www.rfc-editor.org/rfc/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9180">[RFC9180]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Lipp, B.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Hybrid Public Key Encryption"</span>, <span class="seriesInfo">RFC 9180</span>, <span class="seriesInfo">DOI 10.17487/RFC9180</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9180">https://www.rfc-editor.org/rfc/rfc9180</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9380">[RFC9380]</dt>
        <dd>
<span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Scott, S.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Wahby, R. S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="seriesInfo">RFC 9380</span>, <span class="seriesInfo">DOI 10.17487/RFC9380</span>, <time datetime="2023-08" class="refDate">August 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9380">https://www.rfc-editor.org/rfc/rfc9380</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9497">[RFC9497]</dt>
        <dd>
<span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Oblivious Pseudorandom Functions (OPRFs) Using Prime-Order Groups"</span>, <span class="seriesInfo">RFC 9497</span>, <span class="seriesInfo">DOI 10.17487/RFC9497</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9497">https://www.rfc-editor.org/rfc/rfc9497</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC2">[SEC2]</dt>
        <dd>
<span class="refAuthor">Certicom Research</span>, <span class="refTitle">"SEC 2: Recommended Elliptic Curve Domain Parameters, Version 2.0"</span>, <span class="seriesInfo">SEC 2 Version 2.0</span>, <time datetime="2010-01" class="refDate">January 2010</time>, <span>&lt;<a href="https://www.secg.org/sec2-v2.pdf">https://www.secg.org/sec2-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TR03111">[TR03111]</dt>
      <dd>
<span class="refAuthor">Federal Office for Information Security (BSI)</span>, <span class="refTitle">"Elliptic Curve Cryptography"</span>, <span class="seriesInfo">BSI TR-03111 Version 2.10</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.bsi.bund.de/EN/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Technische-Richtlinien/TR-nach-Thema-sortiert/tr03111/tr-03111.html">https://www.bsi.bund.de/EN/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Technische-Richtlinien/TR-nach-Thema-sortiert/tr03111/tr-03111.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BIP32">[BIP32]</dt>
        <dd>
<span class="refAuthor">Wuille, P.</span>, <span class="refTitle">"Hierarchical Deterministic Wallets"</span>, <span class="seriesInfo">BIP 32</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki">https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="draft-OpenID4VCI">[draft-OpenID4VCI]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Yasuda, K.</span>, and <span class="refAuthor">T. Looker</span>, <span class="refTitle">"OpenID for Verifiable Credential Issuance, draft 13"</span>, <time datetime="2024-02-08" class="refDate">8 February 2024</time>, <span>&lt;<a href="https://openid.net/specs/openid-4-verifiable-credential-issuance-1_0.html">https://openid.net/specs/openid-4-verifiable-credential-issuance-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EU2015-1502">[EU2015-1502]</dt>
        <dd>
<span class="refAuthor">European Commission</span>, <span class="refTitle">"Commission Implementing Regulation (EU) 2015/1502 of 8 September 2015 on setting out minimum technical specifications and procedures for assurance levels for electronic identification means"</span>, <span class="seriesInfo">(EU) 2015/1502</span>, <time datetime="2025-09" class="refDate">September 2025</time>, <span>&lt;<a href="https://eur-lex.europa.eu/legal-content/TXT/?uri=CELEX%3A32015R1502">https://eur-lex.europa.eu/legal-content/TXT/?uri=CELEX%3A32015R1502</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EU2024-1183">[EU2024-1183]</dt>
        <dd>
<span class="refAuthor">The European Parliament and the Council of the European Union</span>, <span class="refTitle">"Amending Regulation (EU) No 910/2014 as regards establishing the European Digital Identity Framework"</span>, <span class="seriesInfo">(EU) 2024/1183</span>, <time datetime="2024-04" class="refDate">April 2024</time>, <span>&lt;<a href="https://data.europa.eu/eli/reg/2024/1183/oj">https://data.europa.eu/eli/reg/2024/1183/oj</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-bradleylundberg-cfrg-arkg-02">[I-D.draft-bradleylundberg-cfrg-arkg-02]</dt>
        <dd>
<span class="refAuthor">Lundberg, E.</span> and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"The Asynchronous Remote Key Generation (ARKG) algorithm"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-bradleylundberg-cfrg-arkg-02</span>, <time datetime="2024-05-27" class="refDate">27 May 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-bradleylundberg-cfrg-arkg-02">https://datatracker.ietf.org/doc/html/draft-bradleylundberg-cfrg-arkg-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-irtf-cfrg-signature-key-blinding-07">[I-D.draft-irtf-cfrg-signature-key-blinding-07]</dt>
        <dd>
<span class="refAuthor">Denis, F.</span>, <span class="refAuthor">Eaton, E.</span>, <span class="refAuthor">Lepoint, T.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Key Blinding for Signature Schemes"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-signature-key-blinding-07</span>, <time datetime="2024-09-23" class="refDate">23 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-signature-key-blinding-07">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-signature-key-blinding-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7800">[RFC7800]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)"</span>, <span class="seriesInfo">RFC 7800</span>, <span class="seriesInfo">DOI 10.17487/RFC7800</span>, <time datetime="2016-04" class="refDate">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7800">https://www.rfc-editor.org/rfc/rfc7800</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8235">[RFC8235]</dt>
        <dd>
<span class="refAuthor">Hao, F., Ed.</span>, <span class="refTitle">"Schnorr Non-interactive Zero-Knowledge Proof"</span>, <span class="seriesInfo">RFC 8235</span>, <span class="seriesInfo">DOI 10.17487/RFC8235</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8235">https://www.rfc-editor.org/rfc/rfc8235</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Verheul2024">[Verheul2024]</dt>
        <dd>
<span class="refAuthor">Verheul, E.</span>, <span class="refTitle">"Attestation Proof of Association – provability that attestation keys are bound to the same hardware and person"</span>, <time datetime="2024-09-18" class="refDate">18 September 2024</time>, <span>&lt;<a href="https://eprint.iacr.org/2024/1444">https://eprint.iacr.org/2024/1444</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Wilson2023">[Wilson2023]</dt>
      <dd>
<span class="refAuthor">Wilson, S. M.</span>, <span class="refTitle">"Post-Quantum Account Recovery for Passwordless Authentication. Master’s thesis"</span>, <time datetime="2023-04-24" class="refDate">24 April 2023</time>, <span>&lt;<a href="https://hdl.handle.net/10012/19316">https://hdl.handle.net/10012/19316</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">This design is based on ideas introduced to the EU Digital Identity domain by Peter Lee Altmann.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">Helpful feedback came from Emil Lundberg, John Bradley and Remco Schaar.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="appendix-B">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Micha Kraus</span></div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Sander Dijkhuis (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Cleverbase</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mail@sanderdijkhuis.nl" class="email">mail@sanderdijkhuis.nl</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
